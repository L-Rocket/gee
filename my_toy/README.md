# ğŸ“ Go Webæ¡†æ¶å­¦ä¹ æŒ‡å—

ä»é›¶å¼€å§‹ç†è§£Webæ¡†æ¶çš„æœ¬è´¨ï¼Œé€æ­¥æ„å»ºè‡ªå·±çš„æ¡†æ¶ã€‚

## ğŸ“š å­¦ä¹ è·¯å¾„

### Step 1: HTTPåŸºç¡€ (`step1_http_basic.go`)
**å­¦ä¹ ç›®æ ‡**ï¼šç†è§£Goçš„`net/http`æ ‡å‡†åº“

- ä»€ä¹ˆæ˜¯HTTPæœåŠ¡å™¨ï¼Ÿ
- `http.Handler`æ¥å£
- `http.ResponseWriter`å’Œ`*http.Request`
- ä¸‰ç§åˆ›å»ºHTTPå¤„ç†å™¨çš„æ–¹å¼

**è¿è¡Œ**ï¼š
```bash
go run step1_http_basic.go
curl http://localhost:8003/
```

**æ ¸å¿ƒçŸ¥è¯†**ï¼š
```go
// HTTPå¤„ç†å™¨çš„æœ¬è´¨ï¼šä¸€ä¸ªæ¥æ”¶è¯·æ±‚ã€è¿”å›å“åº”çš„å‡½æ•°
func handler(w http.ResponseWriter, r *http.Request) {
    fmt.Fprintf(w, "Hello!")
}
```

---

### Step 2: è·¯ç”±ç³»ç»Ÿ (`step2_routing.go`)
**å­¦ä¹ ç›®æ ‡**ï¼šç†è§£è·¯ç”±çš„æœ¬è´¨

- ä¸ºä»€ä¹ˆéœ€è¦è·¯ç”±ï¼Ÿ
- è·¯ç”±çš„æ ¸å¿ƒï¼š`map[è·¯å¾„]å¤„ç†å‡½æ•°`
- å¦‚ä½•å®ç°ä¸€ä¸ªç®€å•çš„è·¯ç”±å™¨
- GETã€POSTç­‰HTTPæ–¹æ³•çš„åŒºåˆ«

**è¿è¡Œ**ï¼š
```bash
go run step2_routing.go
curl http://localhost:8004/
curl http://localhost:8004/hello?name=å¼ ä¸‰
curl -X POST http://localhost:8004/login -d 'username=admin&password=123'
```

**æ ¸å¿ƒçŸ¥è¯†**ï¼š
```go
// è·¯ç”±å™¨ = map + ServeHTTP
type Router struct {
    handlers map[string]http.HandlerFunc  // "GET-/hello" -> handler
}

func (r *Router) ServeHTTP(w http.ResponseWriter, req *http.Request) {
    key := req.Method + "-" + req.URL.Path
    if handler, ok := r.handlers[key]; ok {
        handler(w, req)  // æ‰¾åˆ°è·¯ç”±ï¼Œæ‰§è¡Œ
    }
}
```

---

### Step 3: ä¸Šä¸‹æ–‡å°è£… (`step3_context.go`)
**å­¦ä¹ ç›®æ ‡**ï¼šç†è§£Contextçš„ä»·å€¼

- ä¸ºä»€ä¹ˆéœ€è¦Contextï¼Ÿ
- å¦‚ä½•å°è£…å¸¸ç”¨æ“ä½œ
- ç®€åŒ–å‚æ•°è·å–ï¼ˆQueryã€PostFormï¼‰
- ç®€åŒ–å“åº”ï¼ˆJSONã€HTMLã€Stringï¼‰

**è¿è¡Œ**ï¼š
```bash
go run step3_context.go
curl http://localhost:8005/
curl http://localhost:8005/api/user
curl -X POST http://localhost:8005/login -d 'username=admin&password=123'
```

**æ ¸å¿ƒçŸ¥è¯†**ï¼š
```go
// å¯¹æ¯”ï¼šä½¿ç”¨Contextå‰åçš„ä»£ç 

// âŒ åŸå§‹æ–¹å¼ï¼šç¹ç
func handler(w http.ResponseWriter, r *http.Request) {
    name := r.URL.Query().Get("name")
    w.Header().Set("Content-Type", "text/plain")
    w.WriteHeader(200)
    fmt.Fprintf(w, "Hello %s", name)
}

// âœ… ä½¿ç”¨Contextï¼šç®€æ´
func handler(c *Context) {
    name := c.Query("name")
    c.String(200, "Hello %s", name)
}
```

---

### Step 4: å®Œæ•´æ¡†æ¶ (`step4_framework.go`)
**å­¦ä¹ ç›®æ ‡**ï¼šæ„å»ºå®Œæ•´çš„Webæ¡†æ¶

- æ¡†æ¶çš„æ¶æ„è®¾è®¡
- Engineã€Routerã€Contextçš„åä½œ
- ä¼˜é›…çš„APIè®¾è®¡
- å’ŒGinã€Echoç­‰æ¡†æ¶çš„å¯¹æ¯”

**è¿è¡Œ**ï¼š
```bash
go run step4_framework.go
curl http://localhost:8006/
curl http://localhost:8006/hello?name=æå››
```

**æ ¸å¿ƒçŸ¥è¯†**ï¼š
```go
// å®Œæ•´æ¡†æ¶çš„ä½¿ç”¨æ–¹å¼
func main() {
    r := New()  // åˆ›å»ºå¼•æ“
    
    r.GET("/hello", func(c *Context) {  // æ³¨å†Œè·¯ç”±
        c.String(200, "Hello!")
    })
    
    r.Run(":8080")  // å¯åŠ¨æœåŠ¡å™¨
}
```

---

## ğŸ—ï¸ Webæ¡†æ¶çš„æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·ä»£ç                              â”‚
â”‚  r := New()                          â”‚
â”‚  r.GET("/hello", handler)            â”‚
â”‚  r.Run(":8080")                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Engine (å¼•æ“)                        â”‚
â”‚  - æ¡†æ¶å…¥å£                           â”‚
â”‚  - ç®¡ç†Router                         â”‚
â”‚  - å®ç°http.Handleræ¥å£               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Router (è·¯ç”±å™¨)                      â”‚
â”‚  - å­˜å‚¨è·¯ç”±æ˜ å°„è¡¨                      â”‚
â”‚  - åŒ¹é…è¯·æ±‚åˆ°å¤„ç†å‡½æ•°                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Context (ä¸Šä¸‹æ–‡)                     â”‚
â”‚  - å°è£…Request/Response               â”‚
â”‚  - æä¾›ä¾¿æ·æ–¹æ³•                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  HandlerFunc (å¤„ç†å‡½æ•°)               â”‚
â”‚  - ä¸šåŠ¡é€»è¾‘                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ HTTPè¯·æ±‚å¤„ç†æµç¨‹

```
1. å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚
   curl http://localhost:8080/hello?name=å¼ ä¸‰
              â†“
2. Goæ ‡å‡†åº“æ¥æ”¶è¯·æ±‚
   http.ListenAndServe()
              â†“
3. è°ƒç”¨æ¡†æ¶çš„ServeHTTPæ–¹æ³•
   Engine.ServeHTTP(w, req)
              â†“
4. åˆ›å»ºContextä¸Šä¸‹æ–‡
   c := NewContext(w, req)
              â†“
5. è·¯ç”±å™¨æŸ¥æ‰¾å¤„ç†å‡½æ•°
   router.handle(c)
              â†“
6. æ‰§è¡Œå¤„ç†å‡½æ•°
   handler(c)
              â†“
7. è¿”å›å“åº”ç»™å®¢æˆ·ç«¯
   c.String(200, "Hello å¼ ä¸‰")
```

## ğŸ“– æ ¸å¿ƒæ¦‚å¿µæ€»ç»“

### 1. HTTP Handler
- ä»»ä½•å®ç°äº†`ServeHTTP(ResponseWriter, *Request)`çš„ç±»å‹
- è¿™æ˜¯Go HTTPçš„æ ¸å¿ƒæ¥å£

### 2. Routerï¼ˆè·¯ç”±å™¨ï¼‰
- æœ¬è´¨ï¼šä¸€ä¸ªmapï¼Œå­˜å‚¨`è·¯å¾„â†’å¤„ç†å‡½æ•°`çš„æ˜ å°„
- èŒè´£ï¼šæ ¹æ®è¯·æ±‚çš„è·¯å¾„å’Œæ–¹æ³•ï¼Œæ‰¾åˆ°å¯¹åº”çš„å¤„ç†å‡½æ•°

### 3. Contextï¼ˆä¸Šä¸‹æ–‡ï¼‰
- å°è£…äº†`http.ResponseWriter`å’Œ`*http.Request`
- æä¾›ä¾¿æ·æ–¹æ³•ï¼Œç®€åŒ–å¼€å‘
- è¿™æ˜¯ç°ä»£Webæ¡†æ¶çš„æ ¸å¿ƒè®¾è®¡

### 4. Engineï¼ˆå¼•æ“ï¼‰
- æ¡†æ¶çš„å¯¹å¤–æ¥å£
- ç®¡ç†è·¯ç”±å™¨
- æä¾›`GET/POST/Run`ç­‰æ–¹æ³•

## ğŸ¯ å’Œä½ çš„Geeæ¡†æ¶å¯¹æ¯”

ä½ çš„`day2-http-context`é¡¹ç›®ï¼š

```
my_toy/              â†â†’  day2-http-context/
â”œâ”€â”€ step4_framework      â”œâ”€â”€ gee/
â”‚   â”œâ”€â”€ Engine           â”‚   â”œâ”€â”€ gee.go    (Engine)
â”‚   â”œâ”€â”€ Router           â”‚   â”œâ”€â”€ router.go (Router)
â”‚   â””â”€â”€ Context          â”‚   â””â”€â”€ context.go (Context)
â”‚                        â””â”€â”€ main.go
```

å®Œå…¨ä¸€æ ·çš„æ¶æ„ï¼ä½ å·²ç»åœ¨å­¦ä¹ è¿™ä¸ªäº†ï¼

## ğŸš€ ä¸‹ä¸€æ­¥å­¦ä¹ 

1. **åŠ¨æ€è·¯ç”±**ï¼šæ”¯æŒ`/user/:id`ã€`/files/*filepath`
2. **ä¸­é—´ä»¶**ï¼šæ—¥å¿—ã€è®¤è¯ã€é”™è¯¯æ¢å¤
3. **è·¯ç”±åˆ†ç»„**ï¼š`v1 := r.Group("/api/v1")`
4. **æ¨¡æ¿æ¸²æŸ“**ï¼šé›†æˆ`html/template`
5. **é™æ€æ–‡ä»¶**ï¼š`r.Static("/assets", "./static")`

## ğŸ’¡ æµ‹è¯•æ‰€æœ‰æ­¥éª¤

```bash
# ä¸€æ¬¡æ€§æµ‹è¯•æ‰€æœ‰æ­¥éª¤
cd /home/lea/code_learn/Go/Gee/my_toy

# Step 1
go run step1_http_basic.go &
sleep 1 && curl http://localhost:8003/ && kill %1

# Step 2
go run step2_routing.go &
sleep 1 && curl http://localhost:8004/hello?name=æµ‹è¯• && kill %1

# Step 3
go run step3_context.go &
sleep 1 && curl http://localhost:8005/api/user && kill %1

# Step 4
go run step4_framework.go &
sleep 1 && curl http://localhost:8006/ && kill %1
```

## ğŸ“ å…³é”®è¦ç‚¹

1. **Webæ¡†æ¶ä¸æ˜¯é­”æ³•**ï¼šå®ƒå°±æ˜¯åœ¨`net/http`ä¹‹ä¸Šçš„å°è£…
2. **æ ¸å¿ƒæ˜¯è·¯ç”±**ï¼šå°†URLæ˜ å°„åˆ°å¤„ç†å‡½æ•°
3. **Contextæ˜¯å…³é”®**ï¼šç®€åŒ–äº†80%çš„é‡å¤ä»£ç 
4. **è®¾è®¡æ¨¡å¼**ï¼šè£…é¥°å™¨ã€é€‚é…å™¨ã€å·¥å‚æ¨¡å¼çš„ç»¼åˆè¿ç”¨

ç°åœ¨ä½ å·²ç»å®Œå…¨ç†è§£äº†Webæ¡†æ¶çš„æœ¬è´¨ï¼ğŸ‰
